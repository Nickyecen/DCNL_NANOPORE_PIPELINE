// CONFIGURATION FILE

// Pipeline parameter default values, can be modified by user when calling
// pipeline on command line (e.g. --ont_reads_fq sample_1.fastq)

params {
    // Input reference fasta file
    ref = 'None' 
    // Step of pipeline to execute
    step = 'None'
    // Output directory for pipeline results
    out_dir = "output_directory/" 
    // directory of basecalling data
    basecall_path = 'None' 
    // MAPQ filtering threshold for bam files, 0 for no filtering
    mapq = "10" 
    // Quality score threshold
    qscore_thresh = "9"
    // Desired basecall speed 
    basecall_speed = "hac"
    // Desired basecaller modifications
    basecall_mods = false
    // Threshold for mapped reasds
    min_mapped_reads_thresh = 500
    // Desired basecall configuration
    basecall_config = "None"
    // Type of read trimming during basecalling ("all", "primers", "adapters", "none")
    basecall_trim = "none"
    // Basecalling demultiplexing
    basecall_demux = false
    // CPU vs GPU basecalling
    basecall_compute = "gpu"
    // Trim barcodes (only counts if demultiplexing is enabled)
    trim_barcode = "True"
    // Add prefix to all output files
    prefix = "None"
    // Which GPU devices to use for basecalling?
    gpu_devices = "all"
    // Previous results
    steps_2_and_3_input_directory = "None"
    // MultiQC config
    multiqc_config = "None"
    // Are the files from MinKNOW barcoded or not 
    is_barcoded = true
}

// queue_size depends on the step
includeConfig ({
    if (params.step == 1) { return './configs/queue-basecalling.config' }
    else { return './configs/queue-default.config' }
}())

process { 
    // Define local cpu execution
    withLabel: cpu {
        executor='local'
    }
    // Define local gpu execution
    withLabel: gpu {
        executor='local'
        containerOptions = '--nv'
    }
    // Define the container for every process
    container = "./images/debian-nanopore.sif"
}

executor {
	name = 'local'
	queueSize = params.queue_size
}

apptainer {
	enabled = true
	pullTimeout = '60m'
}
